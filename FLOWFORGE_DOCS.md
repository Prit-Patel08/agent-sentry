# üõ°Ô∏è FlowForge ‚Äî CLI Documentation

Auto-generated reference for all commands, flags, and configuration.

---

## Table of Contents

- [Commands](#commands)
- [Configuration](#configuration)
- [Environment Variables](#environment-variables)

## Commands

### `flowforge`

FlowForge is a CLI tool designed to supervise and monitor subprocesses.
It captures stdout/stderr, monitors CPU usage, and handles graceful shutdowns.

**Usage:** `flowforge [flags]`

**Flags:**

```
      --config string    config file (default is ./flowforge.yaml)
      --profile string   monitoring profile: light, standard, heavy (overrides config file)
  -v, --verbose          verbose output
```

### `flowforge dashboard`

Starts the HTTP API server on port 8080.
This allows the Next.js dashboard to query incident history.

**Usage:** `flowforge dashboard`

**Global Flags:**

```
      --config string    config file (default is ./flowforge.yaml)
      --profile string   monitoring profile: light, standard, heavy (overrides config file)
  -v, --verbose          verbose output
```

### `flowforge docs`

Generates a comprehensive FLOWFORGE_DOCS.md file listing
all available commands, flags, and configuration options.

**Usage:** `flowforge docs [flags]`

**Flags:**

```
  -h, --help   help for docs
```

**Global Flags:**

```
      --config string    config file (default is ./flowforge.yaml)
      --profile string   monitoring profile: light, standard, heavy (overrides config file)
  -v, --verbose          verbose output
```

### `flowforge report`

Generates a beautiful Markdown report for a specific incident.
Example:
  flowforge report --id 3

**Usage:** `flowforge report [flags]`

**Flags:**

```
      --id int   Incident ID to generate report for (required)
```

**Global Flags:**

```
      --config string    config file (default is ./flowforge.yaml)
      --profile string   monitoring profile: light, standard, heavy (overrides config file)
  -v, --verbose          verbose output
```

### `flowforge run`

Starts a subprocess, captures its stdout/stderr, and monitors its CPU usage.
Example:
  flowforge run --model gpt-4 -- python3 script.py
  flowforge run --max-cpu 80.0 -- ./my-binary
  flowforge run --no-kill -- python3 stuck.py   (watchdog mode)
  flowforge run --inject-feedback agent_feedback.txt -- python3 agent.py

**Usage:** `flowforge run -- <command> [args...] [flags]`

**Flags:**

```
      --inject-feedback string   Path to feedback file to inject into subprocess stdin
      --max-cpu float            Maximum CPU usage threshold (Default: 90.0) (default 90)
      --model string             Model name for ROI calculation (default "gpt-4")
      --no-kill                  Watchdog mode: log & alert on loops but don't kill the process
```

**Global Flags:**

```
      --config string    config file (default is ./flowforge.yaml)
      --profile string   monitoring profile: light, standard, heavy (overrides config file)
  -v, --verbose          verbose output
```

---

## Configuration

FlowForge reads configuration from `flowforge.yaml` in the current directory.

### Config File Reference

```yaml
# Maximum CPU threshold before loop detection triggers
max-cpu: 90.0

# Active monitoring profile (light | standard | heavy)
profile: standard

# Profile Definitions
profiles:
  light:
    max-cpu: 95.0
    poll-interval: 1000  # ms between CPU checks
    log-window: 5        # lines for stagnation check

  standard:
    max-cpu: 90.0
    poll-interval: 500
    log-window: 10

  heavy:
    max-cpu: 80.0
    poll-interval: 250
    log-window: 20
```

### Profile Priority

1. CLI flags (e.g. `--max-cpu 80`)
2. `--profile` flag (e.g. `--profile heavy`)
3. `profile` key in `flowforge.yaml`
4. Default: `standard`

---

## Environment Variables

| Variable | Description |
|---|---|
| `FLOWFORGE_API_KEY` | API key for securing `/process/kill` and `/process/restart` endpoints. When unset, endpoints are open. |
| `NEXT_PUBLIC_FLOWFORGE_API_KEY` | API key for the dashboard frontend (must match `FLOWFORGE_API_KEY`). |

---

*Generated by `flowforge docs`*
